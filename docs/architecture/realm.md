# Realm

**Realm** · `internal/`

Слой бизнес-логики. Всё что уникально для этого проекта — живёт здесь.

---

## Концепт

Realm — слой в котором сосредоточена вся бизнес-логика системы. Всё что нельзя перенести в другой проект без переосмысления, всё что описывает поведение именно этого приложения — это Realm.

Realm определяет что происходит при каждом входящем запросе или событии. Форма запроса, форма ответа, порядок вызовов, коды ошибок — это решения бизнеса, и все они живут здесь. `internal/` в Go — специальное ключевое слово: компилятор запрещает импортировать эти пакеты снаружи модуля, бизнес-логика не может просочиться наружу по ошибке.

Realm не делает вид что не зависит от транспорта. Delivery честно описывает себя под конкретный транспорт: endpoint знает path, method, handlers. Engine предоставляет примитивы — Realm использует их для выражения бизнес-решений.

### Сущности

**Delivery** — что происходит при входящем запросе или событии. Здесь описывается конкретная бизнес-логика: какие сервисы вызвать, что вернуть, как обработать ошибку.

**Models** — сущности предметной области. Общий язык внутри Realm: структуры данных которые описывают бизнес-объекты проекта.

**Utils** — stateless вспомогательные функции специфичные для этого проекта. Конвертации, форматирование, утилиты.

---

## Структура

```
internal/
├── delivery/
│   ├── endpoints/
│   │   ├── endpoints.go         — список всех HTTP endpoints, возвращает []apps.Endpoint
│   │   └── exec/                — один endpoint = одна папка
│   │       ├── endpoint.go      — метод, путь, цепочка handlers
│   │       ├── handlers.go      — цепочка fiber.Handler, каждая функция — один шаг
│   │       ├── params.go        — Params: структура + InitParams() + GetParams()
│   │       └── response.go      — Response: структура + InitResponse() + GetResponse()
│   ├── consumers/
│   │   └── new_task.go          — handler-функция для consumer
│   └── events/
│       └── user_created.go      — handler для внутреннего eventbus
├── models/
│   ├── task.go                  — plain struct сущности
│   └── user.go
└── utils/
    ├── format.go
    └── convert.go
```

→ [Подробнее о Delivery](/architecture/delivery) · [Подробнее о Models](/architecture/models)
